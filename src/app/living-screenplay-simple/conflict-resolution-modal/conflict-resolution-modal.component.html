<!--
  Conflict Resolution Modal Template
  ✅ Normalizado seguindo especificação de modais padrão v1.0
  ✅ Usa BaseModalComponent para comportamentos consistentes
  ✅ ARIA compliant (WCAG 2.1 AA)
-->
<div class="modal-backdrop"
     *ngIf="isVisible"
     (click)="onBackdropClick($event)"
     role="dialog"
     aria-modal="true"
     aria-labelledby="conflict-modal-title">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <!-- Header reutilizável -->
    <app-modal-header
      id="conflict-modal-title"
      title="Conflito de Arquivo Detectado"
      icon="fas fa-exclamation-triangle"
      [showCloseButton]="true"
      (close)="onCancel()">
    </app-modal-header>

    <div class="modal-body">
      <div class="conflict-info">
        <p class="main-message">
          Um roteiro com o mesmo nome já existe no sistema:
        </p>

        <div class="file-comparison">
          <div class="file-info existing">
            <div class="file-header">
              <i class="fas fa-file-alt"></i>
              <strong>Roteiro Existente</strong>
            </div>
            <div class="file-details">
              <div class="detail-item">
                <span class="label">Nome:</span>
                <span class="value">{{ existingScreenplay?.name }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Tamanho:</span>
                <span class="value">{{ existingContentLength }} caracteres</span>
              </div>
              <div class="detail-item" *ngIf="existingScreenplay?.updatedAt">
                <span class="label">Modificado:</span>
                <span class="value">{{ existingScreenplay?.updatedAt | date:'short' }}</span>
              </div>
            </div>
          </div>

          <div class="comparison-arrow">
            <i class="fas fa-exchange-alt"></i>
          </div>

          <div class="file-info new">
            <div class="file-header">
              <i class="fas fa-file-import"></i>
              <strong>Novo Arquivo</strong>
            </div>
            <div class="file-details">
              <div class="detail-item">
                <span class="label">Nome:</span>
                <span class="value">{{ newFileName }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Tamanho:</span>
                <span class="value">{{ newContentLength }} caracteres</span>
              </div>
              <div class="detail-item">
                <span class="label">Diferença:</span>
                <span class="value">{{ contentDifference }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="rename-section" *ngIf="showRenameInput">
        <label for="rename-input">Novo nome para o arquivo:</label>
        <input
          id="rename-input"
          type="text"
          [(ngModel)]="newName"
          placeholder="Digite o novo nome"
          (keyup.enter)="onRename()"
          (keyup.escape)="showRenameInput = false"
          autofocus>
      </div>

    </div>

    <!-- Footer reutilizável com botões dinâmicos -->
    <app-modal-footer
      [buttons]="showRenameInput ? renameButtons : defaultButtons"
      (buttonClick)="handleFooterAction($event)">
    </app-modal-footer>
  </div>
</div>
